var gameLogic;!function(a){function b(){for(var b=[],c=0;c<a.ROWS;c++){b[c]=[];for(var d=0;d<a.COLS;d++)b[c][d]={playerId:-1,numMolecules:0}}return b}function c(){return{board:b(),delta:null}}function d(a){return!1}function e(a){return f(0,a)?"0":f(1,a)?"1":""}function f(b,c){for(var d=0,e=0;e<a.ROWS;e++)for(var f=0;f<a.COLS;f++){var g=c[e][f];if(d+=g.numMolecules,0!==g.numMolecules&&g.playerId!==b)return!1}return!(2>d)}function g(a,b,f,g){a||(a=c());var h=a.board;if(h[b][f].playerId!==g&&-1!==h[b][f].playerId)throw new Error("One can only make a move in an empty position or its own color!");if(""!==e(h)||d(h))throw new Error("Can only make a move if the game is not over!");var j=angular.copy(h);j[b][f].playerId=g,j[b][f].numMolecules++;var k,l,m=i(b,f,j,g),n=e(j);return""!==n||d(j)?(l=-1,k="0"===n?[1,0]:"1"===n?[0,1]:[0,0]):(l=1-g,k=null),{endMatchScores:k,turnIndexAfterMove:l,stateAfterMove:m}}function h(b,c){var d=4;return 0!=b&&b!=a.ROWS-1||d--,0!=c&&c!=a.COLS-1||d--,d}function i(a,b,c,d){var e={row:a,col:b},g=[],i={cellsExploded:[],boardAfterExplosions:angular.copy(c)};if(g.push(i),c[a][b].numMolecules<h(a,b)){var j={currMoveCell:e,explosions:g},k={delta:j,board:c};return k}for(var l=[e],m=[],n={cellsExploded:[],boardAfterExplosions:c};l.length>0;){var o=angular.copy(l[0]);l.splice(0,1),c[o.row][o.col].numMolecules=c[o.row][o.col].numMolecules-h(o.row,o.col),0===c[o.row][o.col].numMolecules&&(c[o.row][o.col].playerId=-1);try{if(c[o.row-1][o.col].playerId=d,c[o.row-1][o.col].numMolecules++,c[o.row-1][o.col].numMolecules===h(o.row-1,o.col)){var p={row:o.row-1,col:o.col};m.push(p)}}catch(q){}try{if(c[o.row+1][o.col].playerId=d,c[o.row+1][o.col].numMolecules++,c[o.row+1][o.col].numMolecules===h(o.row+1,o.col)){var p={row:o.row+1,col:o.col};m.push(p)}}catch(q){}try{if(c[o.row][o.col-1].playerId=d,c[o.row][o.col-1].numMolecules++,c[o.row][o.col-1].numMolecules===h(o.row,o.col-1)){var p={row:o.row,col:o.col-1};m.push(p)}}catch(q){}try{if(c[o.row][o.col+1].playerId=d,c[o.row][o.col+1].numMolecules++,c[o.row][o.col+1].numMolecules===h(o.row,o.col+1)){var p={row:o.row,col:o.col+1};m.push(p)}}catch(q){}if(n.cellsExploded.push(o),n.boardAfterExplosions=angular.copy(c),f(d,c)){g.push(n);var r={currMoveCell:e,explosions:g},s={delta:r,board:c};return s}0==l.length&&(l=angular.copy(m),m=[],g.push(angular.copy(n)),n.cellsExploded=[],n.boardAfterExplosions=angular.copy(c))}var t={currMoveCell:e,explosions:g},u={delta:t,board:c};return u}function j(a){var b=a.turnIndexBeforeMove,c=a.stateBeforeMove,d=a.move,e=a.move.stateAfterMove.delta,f=e.currMoveCell.row,h=e.currMoveCell.col,i=g(c,f,h,b);if(!angular.equals(d,i))throw new Error("Expected move="+angular.toJson(i,!0)+", but got stateTransition="+angular.toJson(a,!0))}function k(){var b=a.createMove(null,0,0,0),c={turnIndexBeforeMove:0,stateBeforeMove:null,move:b,numberOfPlayers:2};a.checkMoveOk(c)}a.ROWS=9,a.COLS=6,a.getInitialState=c,a.createMove=g,a.checkMoveOk=j,a.forSimpleTestHtml=k}(gameLogic||(gameLogic={}));var game;!function(a){function b(){translate.setTranslations(c()),translate.setLanguage("en"),log.log("Translation of 'RULES_OF_CHAINREACTION' is "+translate("RULES_OF_CHAINREACTION")),resizeGameAreaService.setWidthToHeight(.67),moveService.setGame({minNumberOfPlayers:2,maxNumberOfPlayers:2,checkMoveOk:gameLogic.checkMoveOk,updateUI:f}),document.addEventListener("animationend",d,!1),document.addEventListener("webkitAnimationEnd",d,!1),document.addEventListener("oanimationend",d,!1);var a=window;a.HTMLInspector&&setInterval(function(){a.HTMLInspector.inspect({excludeRules:["unused-classes","script-placement"]})},3e3)}function c(){return{RULES_OF_CHAINREACTION:{en:"Rules of Chain Reaction",fr:"Règles de Chain Reaction"},RULES_SLIDE1:{en:"The objective of Chain Reaction is to take control of the board by eliminating your opponent's atoms.",fr:"L'objectif de Chain Reaction est de prendre le contrôle de tout le plateau en éliminant les orbes de tes adversaires."},RULES_SLIDE2:{en:"Players take turns to place their atoms in a cell. Tap to place an atom in an empty cell or in a cell with same colored atoms.",fr:"Les joueurs jouent tour à tour pour placer leurs orbes dans une case. Appuie pour placer un atome dans une case vide ou avec des atomes de même couleur."},RULES_SLIDE3:{en:"Once a cell has reached its threshold, the atoms explode into the surrounding cells adding an extra atom and claiming the cell for the player.",fr:"Dès qu'une case atteint sa masse critique, les orbes explosent dans les cases voisines en ajoutant une orbe et en donnant cette case au joueur."},RULES_SLIDE4:{en:"As soon as a player loses all their atoms, they are out of the game.",fr:"Sitôt qu'un joueur perd toutes ses orbes, ils sont exclus du jeu."},CLOSE:{en:"Close",fr:"Fermer"}}}function d(){$rootScope.$apply(function(){a.animationEnded=!0,e()})}function e(){log.info("sendComputerMove",a.isComputerTurn),a.isComputerTurn&&(a.isComputerTurn=!1,moveService.makeMove(aiService.findComputerMove(a.move)))}function f(b){log.info("Game got updateUI:",b),a.animationEnded=!1,a.move=b.move,a.state=a.move.stateAfterMove,a.state?r=a.state.delta.explosions.length+1:(a.state=gameLogic.getInitialState(),r=1),a.canMakeMove=a.move.turnIndexAfterMove>=0&&b.yourPlayerIndex===a.move.turnIndexAfterMove,a.isComputerTurn=a.canMakeMove&&""===b.playersInfo[b.yourPlayerIndex].playerId,log.info("updateUI",a.isComputerTurn),a.isComputerTurn&&(a.canMakeMove=!1,a.animationEnded&&e()),q&&$interval.cancel(q),a.round=0,q=$interval(function(){a.round++,a.round==r&&$interval.cancel(q)},300)}function g(b,c){if(log.info("Clicked on cell:",b,c),"?throwException"===window.location.search)throw new Error("Throwing the error because URL has '?throwException'");if(a.canMakeMove)try{var d=gameLogic.createMove(a.state,b,c,a.move.turnIndexAfterMove);a.canMakeMove=!1,moveService.makeMove(d)}catch(e){return void log.info(["Cell is already full in position:",b,c])}}function h(b,c,d){try{return-1!==a.state.delta.explosions[d].boardAfterExplosions[b][c].playerId}catch(e){var f=a.state.board[b][c];return-1!==f.playerId}}function i(b,c,d,e,f){try{var g=a.state.delta.explosions[d].boardAfterExplosions[b][c];return g.playerId===e&&g.numMolecules===f}catch(h){return a.state.board[b][c].playerId===e&&a.state.board[b][c].numMolecules==f}}function j(b,c){var d=4;return 0!=b&&b!=a.ROWS-1||d--,0!=c&&c!=a.COLS-1||d--,d}function k(a,b,c){return!0}function l(a,b,c){for(var d=0;d<a.length;d++)if(a[d].row===b&&a[d].col===c)return!0;return!1}function m(b,c,d){try{return!a.animationEnded&&l(a.state.delta.explosions[d+1].cellsExploded,b,c)}catch(e){return!1}}function n(b,c,d,e){try{return!a.animationEnded&&l(a.state.delta.explosions[d+1].cellsExploded,b,c)&&a.state.delta.explosions[d].boardAfterExplosions[b][c].playerId===e}catch(f){return!1}}function o(b,c,d,e){try{return a.state.delta.explosions[d+1].boardAfterExplosions[b][c].numMolecules>0&&a.state.delta.explosions[d].boardAfterExplosions[b][c].playerId===e}catch(f){return!1}}function p(b){return b.target===b.currentTarget&&(b.preventDefault(),b.stopPropagation(),a.isHelpModalShown=!1),!0}a.animationEnded=!1,a.canMakeMove=!1,a.isComputerTurn=!1,a.move=null,a.state=null,a.isHelpModalShown=!1,a.ROWS=9,a.COLS=6,a.init=b,a.round=0;var q=null,r=10;a.cellClicked=g,a.shouldShowImage=h,a.containsMolOfPlayer=i,a.maxMolecules=j,a.shouldSlowlyAppear=k,a.shouldAnimate=m,a.shouldAnimateForPlayer=n,a.moleculesMoreThanMaxMolecules=o,a.clickedOnModal=p}(game||(game={})),angular.module("myApp",["ngTouch","ui.bootstrap","gameServices"]).run(function(){$rootScope.game=game,game.init()});var aiService;!function(a){function b(a){return d(a)}function c(a,b,c,d){var e;try{e=gameLogic.createMove(d.stateAfterMove,b,c,d.turnIndexAfterMove)}catch(f){return 25}for(var g=e.stateAfterMove.board,h=0,i=0;i<gameLogic.ROWS;i++)for(var j=0;j<gameLogic.COLS;j++)-1!=g[i][j].playerId&&g[i][j].playerId!=d.turnIndexAfterMove&&h++;return h}function d(a){for(var b=a.stateAfterMove.board,d=-1,e=-1,f=25,g=0;g<gameLogic.ROWS;g++)for(var h=0;h<gameLogic.COLS;h++){var i=c(b,g,h,a);f>i&&(d=g,e=h,f=i)}return gameLogic.createMove(a.stateAfterMove,d,e,a.turnIndexAfterMove)}a.findComputerMove=b,a.createComputerMove=d}(aiService||(aiService={}));
//# sourceMappingURL=everything.min.js.map